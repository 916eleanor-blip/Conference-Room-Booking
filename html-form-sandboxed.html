<!DOCTYPE html>
<html lang="en" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Conference Room Booking</title>
<style>
    * { box-sizing: border-box; }
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 40px 20px;
        color: #1d1d1f;
        min-height: 100vh;
    }
    .form-container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 24px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    h1 { 
        font-weight: 700; 
        margin-bottom: 10px; 
        font-size: 36px; 
        color: #1d1d1f;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    .subtitle { color: #86868b; font-size: 17px; margin-bottom: 30px; line-height: 1.5; }
    .form-section { 
        background: #f9f9f9; 
        border-radius: 16px; 
        padding: 0; 
        margin-bottom: 16px; 
        box-shadow: 0 2px 8px rgba(0,0,0,0.06); 
        transition: all 0.3s ease;
        border: 2px solid transparent;
    }
    .form-section:hover { 
        box-shadow: 0 4px 16px rgba(0,0,0,0.1); 
        border-color: #667eea20;
    }
    label { display: block; margin-top: 18px; margin-bottom: 6px; font-size: 14px; font-weight: 500; color: #1d1d1f; }
    label:first-of-type { margin-top: 0; }
    input, select, textarea {
        width: 100%; padding: 12px 14px; margin-top: 0; border: 1.5px solid #d2d2d7;
        border-radius: 10px; font-size: 15px; background: #fff; transition: all 0.2s ease; font-family: inherit;
    }
    input:focus, select:focus, textarea:focus { outline: none; border-color: #007aff; box-shadow: 0 0 0 3px rgba(0,122,255,0.1); }
    textarea { resize: vertical; min-height: 100px; line-height: 1.5; }
    button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white; padding: 16px 32px; border: none; border-radius: 12px;
        font-size: 17px; font-weight: 600; cursor: pointer; margin-top: 24px; transition: all 0.3s ease;
        box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4); width: 100%;
    }
    button:hover { 
        transform: translateY(-2px); 
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5); 
    }
    button:active {
        transform: translateY(0);
    }
    button:disabled { 
        background: linear-gradient(135deg, #d2d2d7 0%, #b8b8bb 100%); 
        cursor: not-allowed; 
        box-shadow: none; 
        transform: none; 
    }
    details { border-radius: 16px; padding: 0; background: #ffffff; overflow: hidden; }
    details[open] summary { border-bottom: 1px solid #f5f5f7; margin-bottom: 0; }
    summary {
        cursor: pointer; font-weight: 600; font-size: 18px; outline: none; padding: 20px 24px;
        user-select: none; transition: all 0.2s ease; list-style: none;
        background: white;
        border-radius: 16px;
    }
    summary::-webkit-details-marker { display: none; }
    summary::before {
        content: 'â€º'; display: inline-block; font-size: 24px; font-weight: 400;
        margin-right: 12px; transition: transform 0.3s ease; 
        color: #667eea;
    }
    details[open] summary::before { transform: rotate(90deg); }
    summary:hover { background: #ffffff; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15); }
    .section-content { padding: 24px; background: white; border-radius: 0 0 16px 16px; }
    .success-message {
        background: linear-gradient(135deg, #34c759 0%, #30d158 100%);
        color: white; padding: 20px 24px; border-radius: 16px; margin-bottom: 24px;
        display: none; box-shadow: 0 4px 16px rgba(52,199,89,0.3); font-size: 17px; font-weight: 600;
        animation: slideIn 0.4s ease;
    }
    .success-message.show { display: block; animation: slideIn 0.4s ease; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    @media (max-width: 768px) {
        body { padding: 20px 16px; }
        h1 { font-size: 28px; }
        summary { font-size: 16px; padding: 16px 20px; }
        .section-content { padding: 20px; }
    }
</style>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:_dlc_DocId msdt:dt="string">DZ65HVCWQ76A-1856187232-116</mso:_dlc_DocId>
<mso:_dlc_DocIdItemGuid msdt:dt="string">916751b4-df35-4764-bffd-00e84fd6c991</mso:_dlc_DocIdItemGuid>
<mso:_dlc_DocIdUrl msdt:dt="string">https://smud.sharepoint.com/sites/Facilities-Operations/_layouts/15/DocIdRedir.aspx?ID=DZ65HVCWQ76A-1856187232-116, DZ65HVCWQ76A-1856187232-116</mso:_dlc_DocIdUrl>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>
<body>

<div class="form-container">
<h1>Conference Room Booking</h1>
<p class="subtitle">Reserve conference rooms and request support services for your meetings and events</p>

<div id="successMsg" class="success-message">
  âœ“ Your booking request has been submitted successfully! You will receive confirmation shortly.
</div>

<div id="confForm">

<details open class="form-section">
  <summary>Basic Information</summary>
  <div class="section-content">
  <label>Who is this request for?</label>
  <input id="WhoIsThisFor" />
  
  <label>Name (your name)</label>
  <input id="Name" />
  
  <label>Meeting Title</label>
  <input id="MeetingTitle" />
  
  <label>Site Location</label>
  <select id="Site">
    <option>Choose One</option>
    <option>HQ CSC FRF</option>
    <option>ECOC East Campus</option>
  </select>
  
  <label>Conference Room</label>
  <select id="Room">
    <option>Choose One</option>
    <option>CSC/Lobby/200 occ</option>
    <option>CSC1SE/Rubicon/100 occ</option>
    <option>CSC2SE/Lighting CLs Rm/34 occ</option>
    <option>EAOSE 052/Ampere 1/203 occ</option>
    <option>EAOSE 054/Ampere 2/57 occ</option>
    <option>EAOSE 054/Ampere 3/54 occ</option>
    <option>EA1SW 109/BELL 1/16 occ</option>
    <option>EA1SW 119/BELL 3/Assembly/34 occ</option>
    <option>HQ102/Auditorium/100 occ</option>
    <option>HQ116/Arden Conference Center/96 occ</option>
    <option>HQB106/Garden Cafe Atrium/40 occ</option>
  </select>
  
  <label>Expected Occupancy</label>
  <input type="number" id="Occupancy" />
  </div>
</details>

<details class="form-section">
  <summary>Date & Time</summary>
  <div class="section-content">
  <label>Start Date/Time</label>
  <input type="datetime-local" id="Start" />
  
  <label>End Date/Time</label>
  <input type="datetime-local" id="End" />
  
  <label>Recurring?</label>
  <select id="Recurring">
    <option>No</option>
    <option>Yes</option>
  </select>
  </div>
</details>

<details class="form-section">
  <summary>Setâ€‘Up Requirements</summary>
  <div class="section-content">
  <label>Meeting Room Layout</label>
  <select id="SetUp">
    <option>Choose</option>
    <option>Classroom</option>
    <option>Theater</option>
    <option>Pods</option>
    <option>Conference A</option>
    <option>Conference B</option>
    <option>Conference D</option>
    <option>Square</option>
    <option>Fair</option>
    <option>CEO</option>
    <option>ERG Leadership</option>
    <option>Meet Buyers</option>
    <option>Committee</option>
    <option>Alternate Board</option>
    <option>Dining Event 1</option>
    <option>Dining Event 2</option>
  </select>
  
  <label>Electrical Needed?</label>
  <select id="Electrical">
    <option>No</option>
    <option>Yes</option>
  </select>
  
  <label>Setâ€‘up Notes</label>
  <textarea id="SetUpNotes"></textarea>
  </div>
</details>

<details class="form-section">
  <summary>Technology</summary>
  <div class="section-content">
  <label>Teams Meeting Link</label>
  <input id="Teams" />
  
  <label>Do you need IT assistance?</label>
  <select id="IT">
    <option>No</option>
    <option>Yes</option>
  </select>
  
  <label>What Type of Meeting?</label>
  <select id="Type">
    <option>Choose One</option>
    <option>Remote</option>
    <option>In Person</option>
  </select>
  
  <label>When should IT arrive?</label>
  <input type="time" id="ITTime" />
  </div>
</details>

<details class="form-section">
  <summary>External & Special Events Security</summary>
  <div class="section-content">
  <label>Special Event?</label>
  <select id="SpecialEvent">
    <option>No</option>
    <option>Yes</option>
  </select>
  
  <label>Organization</label>
  <input id="Organization" />
  
  <label>External Participants?</label>
  <select id="ExternalParticipants">
    <option>No</option>
    <option>Yes</option>
  </select>
  
  <label>How many external participants?</label>
  <input type="number" id="ExternalCount" />
  
  <label>International Guests?</label>
  <select id="InternationalGuests">
    <option>No</option>
    <option>Yes</option>
  </select>
  </div>
</details>

<details class="form-section">
  <summary>Justification</summary>
  <div class="section-content">
  <label>Justification</label>
  <textarea id="Justification"></textarea>
  </div>
</details>

<button type="button" id="submitBtn">Submit Request</button>
</div>

</div>

<script>
// ============================================
// LOCAL STORAGE VERSION 2.0 - NO SHAREPOINT
// ============================================
const STORAGE_KEY = "conferenceRoomBookings";
console.log("ðŸš€ Form Loaded - LOCAL STORAGE MODE v2.0");
console.log("ðŸ“ No SharePoint dependencies");

function getBookings() {
    const data = localStorage.getItem(STORAGE_KEY);
    return data ? JSON.parse(data) : [];
}

function saveBooking(booking) {
    const bookings = getBookings();
    booking.ID = Date.now(); // Unique ID
    booking.Created = new Date().toISOString();
    booking.Approval_x0020_Status = "Pending";
    bookings.push(booking);
    localStorage.setItem(STORAGE_KEY, JSON.stringify(bookings));
    return booking;
}

function buildBookingData() {
    return {
        "Meeting_x0020_title": document.getElementById("MeetingTitle").value || "Conference Room Booking",
        "Who_x0020_is_x0020_this_x0020_re": document.getElementById("WhoIsThisFor").value || "",
        "Name": document.getElementById("Name").value || "",
        "Site": document.getElementById("Site").value || "",
        "Room": document.getElementById("Room").value || "",
        "Occupancy": document.getElementById("Occupancy").value || "",
        "Start": document.getElementById("Start").value || "",
        "End": document.getElementById("End").value || "",
        "Recurring_x003f_": document.getElementById("Recurring").value || "No",
        "Set_x002d_Up": document.getElementById("SetUp").value || "",
        "Electrical_x003f_": document.getElementById("Electrical").value || "No",
        "Set_x002d_up_x0020_Notes": document.getElementById("SetUpNotes").value || "",
        "Teams": document.getElementById("Teams").value || "",
        "IT": document.getElementById("IT").value || "No",
        "M_x0020_Type": document.getElementById("Type").value || "",
        "IT_x0020_Time": document.getElementById("ITTime").value || "",
        "Special_x0020_Event_x003f_": document.getElementById("SpecialEvent").value || "No",
        "Organization": document.getElementById("Organization").value || "",
        "External_x0020_Participants_x003f": document.getElementById("ExternalParticipants").value || "No",
        "External_x0020_Participants_x0020": document.getElementById("ExternalCount").value || "",
        "International_x0020_Guests_x003f": document.getElementById("InternationalGuests").value || "No",
        "Justification": document.getElementById("Justification").value || ""
    };
}

document.getElementById("submitBtn").addEventListener("click", () => {
    console.log("Form submitted - saving locally");
    const submitButton = document.getElementById("submitBtn");
    const successMsg = document.getElementById("successMsg");
    
    submitButton.disabled = true;
    submitButton.textContent = "Submitting...";
    successMsg.classList.remove("show");
    
    try {
        const bookingData = buildBookingData();
        console.log("Booking data:", bookingData);
        
        // Save to localStorage
        const savedBooking = saveBooking(bookingData);
        console.log("Successfully saved:", savedBooking);
        
        successMsg.classList.add("show");
        
        // Reset all fields
        document.querySelectorAll('input, select, textarea').forEach(el => {
            if (el.type === 'checkbox' || el.type === 'radio') el.checked = false;
            else el.value = '';
        });
        
        window.scrollTo({ top: 0, behavior: "smooth" });
        
        // Dispatch event for dashboard to listen to
        window.dispatchEvent(new Event('bookingAdded'));
        
    } catch (error) {
        console.error("Submission error:", error);
        alert("There was an error submitting your request. Please try again.\n\nError: " + error.message);
    } finally {
        submitButton.disabled = false;
        submitButton.textContent = "Submit Request";
    }
});

console.log("Conference Room Booking Form Loaded - Using Local Storage");
</script>

</body>
</html>